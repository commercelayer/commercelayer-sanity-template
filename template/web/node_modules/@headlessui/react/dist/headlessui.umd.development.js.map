{"version":3,"file":"headlessui.umd.development.js","sources":["../src/hooks/use-iso-morphic-effect.ts","../src/hooks/use-id.ts","../src/hooks/use-is-initial-render.ts","../src/utils/match.ts","../src/hooks/use-is-mounted.ts","../src/utils/render.ts","../src/utils/once.ts","../src/utils/disposables.ts","../src/components/transitions/utils/transition.ts","../src/components/transitions/transition.tsx","../src/hooks/use-disposables.ts","../src/hooks/use-sync-refs.ts","../src/components/keyboard.ts","../src/utils/calculate-active-index.ts","../src/utils/resolve-prop-value.ts","../src/utils/bugs.ts","../src/components/menu/menu.tsx","../src/hooks/use-computed.ts","../src/components/listbox/listbox.tsx","../src/components/switch/switch.tsx"],"sourcesContent":["import { useLayoutEffect, useEffect } from 'react'\n\nexport const useIsoMorphicEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect\n","import { useState, useEffect } from 'react'\nimport { useIsoMorphicEffect } from './use-iso-morphic-effect'\n\n// We used a \"simple\" approach first which worked for SSR and rehydration on the client. However we\n// didn't take care of the Suspense case. To fix this we used the approach the @reach-ui/auto-id\n// uses.\n//\n// Credits: https://github.com/reach/reach-ui/blob/develop/packages/auto-id/src/index.tsx\n\nlet state = { serverHandoffComplete: false }\nlet id = 0\nfunction generateId() {\n  return ++id\n}\n\nexport function useId() {\n  let [id, setId] = useState(state.serverHandoffComplete ? generateId : null)\n\n  useIsoMorphicEffect(() => {\n    if (id === null) setId(generateId())\n  }, [id])\n\n  useEffect(() => {\n    if (state.serverHandoffComplete === false) state.serverHandoffComplete = true\n  }, [])\n\n  return id != null ? '' + id : undefined\n}\n","import { useRef, useEffect } from 'react'\n\nexport function useIsInitialRender() {\n  let initial = useRef(true)\n\n  useEffect(() => {\n    initial.current = false\n  }, [])\n\n  return initial.current\n}\n","export function match<TValue extends string | number = string, TReturnValue = unknown>(\n  value: TValue,\n  lookup: Record<TValue, TReturnValue | ((...args: any[]) => TReturnValue)>,\n  ...args: any[]\n): TReturnValue {\n  if (value in lookup) {\n    let returnValue = lookup[value]\n    return typeof returnValue === 'function' ? returnValue(...args) : returnValue\n  }\n\n  let error = new Error(\n    `Tried to handle \"${value}\" but there is no handler defined. Only defined handlers are: ${Object.keys(\n      lookup\n    )\n      .map(key => `\"${key}\"`)\n      .join(', ')}.`\n  )\n  if (Error.captureStackTrace) Error.captureStackTrace(error, match)\n  throw error\n}\n","import { useRef, useEffect } from 'react'\n\nexport function useIsMounted() {\n  let mounted = useRef(true)\n\n  useEffect(() => {\n    return () => {\n      mounted.current = false\n    }\n  }, [])\n\n  return mounted\n}\n","import {\n  Fragment,\n  cloneElement,\n  createElement,\n  forwardRef,\n  isValidElement,\n\n  // Types\n  ElementType,\n  ReactElement,\n} from 'react'\nimport { Props, XOR, __, Expand } from '../types'\nimport { match } from './match'\n\nexport enum Features {\n  /** No features at all */\n  None = 0,\n\n  /**\n   * When used, this will allow us to use one of the render strategies.\n   *\n   * **The render strategies are:**\n   *    - **Unmount**   _(Will unmount the component.)_\n   *    - **Hidden**    _(Will hide the component using the [hidden] attribute.)_\n   */\n  RenderStrategy = 1,\n\n  /**\n   * When used, this will allow the user of our component to be in control. This can be used when\n   * you want to transition based on some state.\n   */\n  Static = 2,\n}\n\nexport enum RenderStrategy {\n  Unmount,\n  Hidden,\n}\n\ntype PropsForFeature<TPassedInFeatures extends Features, TForFeature extends Features, TProps> = {\n  [P in TPassedInFeatures]: P extends TForFeature ? TProps : __\n}[TPassedInFeatures]\n\nexport type PropsForFeatures<T extends Features> = XOR<\n  PropsForFeature<T, Features.Static, { static?: boolean }>,\n  PropsForFeature<T, Features.RenderStrategy, { unmount?: boolean }>\n>\n\nexport function render<TFeature extends Features, TTag extends ElementType, TBag>(\n  props: Expand<Props<TTag, TBag, any> & PropsForFeatures<TFeature>>,\n  propsBag: TBag,\n  defaultTag: ElementType,\n  features?: TFeature,\n  visible: boolean = true\n) {\n  // Visible always render\n  if (visible) return _render(props, propsBag, defaultTag)\n\n  let featureFlags = features ?? Features.None\n\n  if (featureFlags & Features.Static) {\n    let { static: isStatic = false, ...rest } = props as PropsForFeatures<Features.Static>\n\n    // When the `static` prop is passed as `true`, then the user is in control, thus we don't care about anything else\n    if (isStatic) return _render(rest, propsBag, defaultTag)\n  }\n\n  if (featureFlags & Features.RenderStrategy) {\n    let { unmount = true, ...rest } = props as PropsForFeatures<Features.RenderStrategy>\n    let strategy = unmount ? RenderStrategy.Unmount : RenderStrategy.Hidden\n\n    return match(strategy, {\n      [RenderStrategy.Unmount]() {\n        return null\n      },\n      [RenderStrategy.Hidden]() {\n        return _render(\n          { ...rest, ...{ hidden: true, style: { display: 'none' } } },\n          propsBag,\n          defaultTag\n        )\n      },\n    })\n  }\n\n  // No features enabled, just render\n  return _render(props, propsBag, defaultTag)\n}\n\nfunction _render<TTag extends ElementType, TBag>(\n  props: Props<TTag, TBag> & { ref?: unknown },\n  bag: TBag,\n  tag: ElementType\n) {\n  let { as: Component = tag, children, refName = 'ref', ...passThroughProps } = omit(props, [\n    'unmount',\n    'static',\n  ])\n\n  // This allows us to use `<HeadlessUIComponent as={MyComopnent} refName=\"innerRef\" />`\n  let refRelatedProps = props.ref !== undefined ? { [refName]: props.ref } : {}\n\n  let resolvedChildren = (typeof children === 'function' ? children(bag) : children) as\n    | ReactElement\n    | ReactElement[]\n\n  if (Component === Fragment) {\n    if (Object.keys(passThroughProps).length > 0) {\n      if (Array.isArray(resolvedChildren) && resolvedChildren.length > 1) {\n        let err = new Error('You should only render 1 child')\n        if (Error.captureStackTrace) Error.captureStackTrace(err, _render)\n        throw err\n      }\n\n      if (!isValidElement(resolvedChildren)) {\n        let err = new Error(\n          `You should render an element as a child. Did you forget the as=\"...\" prop?`\n        )\n        if (Error.captureStackTrace) Error.captureStackTrace(err, _render)\n        throw err\n      }\n\n      return cloneElement(\n        resolvedChildren,\n        Object.assign(\n          {},\n          // Filter out undefined values so that they don't override the existing values\n          mergeEventFunctions(compact(omit(passThroughProps, ['ref'])), resolvedChildren.props, [\n            'onClick',\n          ]),\n          refRelatedProps\n        )\n      )\n    }\n  }\n\n  return createElement(\n    Component,\n    Object.assign({}, omit(passThroughProps, ['ref']), Component !== Fragment && refRelatedProps),\n    resolvedChildren\n  )\n}\n\n/**\n * We can use this function for the following useCase:\n *\n * <Menu.Item> <button onClick={console.log} /> </Menu.Item>\n *\n * Our `Menu.Item` will have an internal `onClick`, if you passthrough an `onClick` to the actual\n * `Menu.Item` component we will call it correctly. However, when we have an `onClick` on the actual\n * first child, that one should _also_ be called (but before this implementation, it was just\n * overriding the `onClick`). But it is only when we *render* that we have access to the existing\n * props of this component.\n *\n * It's a bit hacky, and not that clean, but it is something internal and we have tests to rely on\n * so that we can refactor this later (if needed).\n */\nfunction mergeEventFunctions(\n  passThroughProps: Record<string, any>,\n  existingProps: Record<string, any>,\n  functionsToMerge: string[]\n) {\n  let clone = Object.assign({}, passThroughProps)\n  for (let func of functionsToMerge) {\n    if (passThroughProps[func] !== undefined && existingProps[func] !== undefined) {\n      Object.assign(clone, {\n        [func](event: { defaultPrevented: boolean }) {\n          // Props we control\n          if (!event.defaultPrevented) passThroughProps[func](event)\n\n          // Existing props on the component\n          if (!event.defaultPrevented) existingProps[func](event)\n        },\n      })\n    }\n  }\n\n  return clone\n}\n\n/**\n * This is a hack, but basically we want to keep the full 'API' of the component, but we do want to\n * wrap it in a forwardRef so that we _can_ passthrough the ref\n */\nexport function forwardRefWithAs<T>(component: T): T {\n  return forwardRef((component as unknown) as any) as any\n}\n\nfunction compact<T extends Record<any, any>>(object: T) {\n  let clone = Object.assign({}, object)\n  for (let key in clone) {\n    if (clone[key] === undefined) delete clone[key]\n  }\n  return clone\n}\n\nfunction omit<T extends Record<any, any>>(object: T, keysToOmit: string[] = []) {\n  let clone = Object.assign({}, object)\n  for (let key of keysToOmit) {\n    if (key in clone) delete clone[key]\n  }\n  return clone\n}\n","export function once<T>(cb: (...args: T[]) => void) {\n  let state = { called: false }\n\n  return (...args: T[]) => {\n    if (state.called) return\n    state.called = true\n    return cb(...args)\n  }\n}\n","export function disposables() {\n  let disposables: Function[] = []\n\n  let api = {\n    requestAnimationFrame(...args: Parameters<typeof requestAnimationFrame>) {\n      let raf = requestAnimationFrame(...args)\n      api.add(() => cancelAnimationFrame(raf))\n    },\n\n    nextFrame(...args: Parameters<typeof requestAnimationFrame>) {\n      api.requestAnimationFrame(() => {\n        api.requestAnimationFrame(...args)\n      })\n    },\n\n    setTimeout(...args: Parameters<typeof setTimeout>) {\n      let timer = setTimeout(...args)\n      api.add(() => clearTimeout(timer))\n    },\n\n    add(cb: () => void) {\n      disposables.push(cb)\n    },\n\n    dispose() {\n      for (let dispose of disposables.splice(0)) {\n        dispose()\n      }\n    },\n  }\n\n  return api\n}\n","import { once } from '../../../utils/once'\nimport { disposables } from '../../../utils/disposables'\n\nfunction addClasses(node: HTMLElement, ...classes: string[]) {\n  node && classes.length > 0 && node.classList.add(...classes)\n}\n\nfunction removeClasses(node: HTMLElement, ...classes: string[]) {\n  node && classes.length > 0 && node.classList.remove(...classes)\n}\n\nexport enum Reason {\n  Finished = 'finished',\n  Cancelled = 'cancelled',\n}\n\nfunction waitForTransition(node: HTMLElement, done: (reason: Reason) => void) {\n  let d = disposables()\n\n  if (!node) return d.dispose\n\n  // Safari returns a comma separated list of values, so let's sort them and take the highest value.\n  let { transitionDuration, transitionDelay } = getComputedStyle(node)\n\n  let [durationMs, delaysMs] = [transitionDuration, transitionDelay].map(value => {\n    let [resolvedValue = 0] = value\n      .split(',')\n      // Remove falseys we can't work with\n      .filter(Boolean)\n      // Values are returned as `0.3s` or `75ms`\n      .map(v => (v.includes('ms') ? parseFloat(v) : parseFloat(v) * 1000))\n      .sort((a, z) => z - a)\n\n    return resolvedValue\n  })\n\n  // Waiting for the transition to end. We could use the `transitionend` event, however when no\n  // actual transition/duration is defined then the `transitionend` event is not fired.\n  //\n  // TODO: Downside is, when you slow down transitions via devtools this timeout is still using the\n  // full 100% speed instead of the 25% or 10%.\n  if (durationMs !== 0) {\n    d.setTimeout(() => {\n      done(Reason.Finished)\n    }, durationMs + delaysMs)\n  } else {\n    // No transition is happening, so we should cleanup already. Otherwise we have to wait until we\n    // get disposed.\n    done(Reason.Finished)\n  }\n\n  // If we get disposed before the timeout runs we should cleanup anyway\n  d.add(() => done(Reason.Cancelled))\n\n  return d.dispose\n}\n\nexport function transition(\n  node: HTMLElement,\n  base: string[],\n  from: string[],\n  to: string[],\n  done?: (reason: Reason) => void\n) {\n  let d = disposables()\n  let _done = done !== undefined ? once(done) : () => {}\n\n  addClasses(node, ...base, ...from)\n\n  d.nextFrame(() => {\n    removeClasses(node, ...from)\n    addClasses(node, ...to)\n\n    d.add(\n      waitForTransition(node, reason => {\n        removeClasses(node, ...to, ...base)\n        return _done(reason)\n      })\n    )\n  })\n\n  // Once we get disposed, we should ensure that we cleanup after ourselves. In case of an unmount,\n  // the node itself will be nullified and will be a no-op. In case of a full transition the classes\n  // are already removed which is also a no-op. However if you go from enter -> leave mid-transition\n  // then we have some leftovers that should be cleaned.\n  d.add(() => removeClasses(node, ...base, ...from, ...to))\n\n  // When we get disposed early, than we should also call the done method but switch the reason.\n  d.add(() => _done(Reason.Cancelled))\n\n  return d.dispose\n}\n","import React, {\n  useMemo,\n  createContext,\n  useContext,\n  useRef,\n  useEffect,\n  useCallback,\n  useState,\n  Fragment,\n\n  // Types\n  ElementType,\n  MutableRefObject,\n} from 'react'\nimport { Props } from '../../types'\n\nimport { useId } from '../../hooks/use-id'\nimport { useIsInitialRender } from '../../hooks/use-is-initial-render'\nimport { match } from '../../utils/match'\nimport { useIsMounted } from '../../hooks/use-is-mounted'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\n\nimport { Features, PropsForFeatures, render, RenderStrategy } from '../../utils/render'\nimport { Reason, transition } from './utils/transition'\n\ntype ID = ReturnType<typeof useId>\n\nfunction useSplitClasses(classes: string = '') {\n  return useMemo(() => classes.split(' ').filter(className => className.trim().length > 1), [\n    classes,\n  ])\n}\n\ninterface TransitionContextValues {\n  show: boolean\n  appear: boolean\n}\nlet TransitionContext = createContext<TransitionContextValues | null>(null)\nTransitionContext.displayName = 'TransitionContext'\n\nenum TreeStates {\n  Visible = 'visible',\n  Hidden = 'hidden',\n}\n\nexport interface TransitionClasses {\n  enter?: string\n  enterFrom?: string\n  enterTo?: string\n  leave?: string\n  leaveFrom?: string\n  leaveTo?: string\n}\n\nexport interface TransitionEvents {\n  beforeEnter?: () => void\n  afterEnter?: () => void\n  beforeLeave?: () => void\n  afterLeave?: () => void\n}\n\ntype TransitionChildProps<TTag> = Props<TTag, TransitionChildRenderPropArg> &\n  PropsForFeatures<typeof TransitionChildRenderFeatures> &\n  TransitionClasses &\n  TransitionEvents & { appear?: boolean }\n\nfunction useTransitionContext() {\n  let context = useContext(TransitionContext)\n\n  if (context === null) {\n    throw new Error('A <Transition.Child /> is used but it is missing a parent <Transition />.')\n  }\n\n  return context\n}\n\nfunction useParentNesting() {\n  let context = useContext(NestingContext)\n\n  if (context === null) {\n    throw new Error('A <Transition.Child /> is used but it is missing a parent <Transition />.')\n  }\n\n  return context\n}\n\ninterface NestingContextValues {\n  children: MutableRefObject<{ id: ID; state: TreeStates }[]>\n  register: (id: ID) => () => void\n  unregister: (id: ID, strategy?: RenderStrategy) => void\n}\n\nlet NestingContext = createContext<NestingContextValues | null>(null)\nNestingContext.displayName = 'NestingContext'\n\nfunction hasChildren(\n  bag: NestingContextValues['children'] | { children: NestingContextValues['children'] }\n): boolean {\n  if ('children' in bag) return hasChildren(bag.children)\n  return bag.current.filter(({ state }) => state === TreeStates.Visible).length > 0\n}\n\nfunction useNesting(done?: () => void) {\n  let doneRef = useRef(done)\n  let transitionableChildren = useRef<NestingContextValues['children']['current']>([])\n  let mounted = useIsMounted()\n\n  useEffect(() => {\n    doneRef.current = done\n  }, [done])\n\n  let unregister = useCallback(\n    (childId: ID, strategy = RenderStrategy.Hidden) => {\n      let idx = transitionableChildren.current.findIndex(({ id }) => id === childId)\n      if (idx === -1) return\n\n      match(strategy, {\n        [RenderStrategy.Unmount]() {\n          transitionableChildren.current.splice(idx, 1)\n        },\n        [RenderStrategy.Hidden]() {\n          transitionableChildren.current[idx].state = TreeStates.Hidden\n        },\n      })\n\n      if (!hasChildren(transitionableChildren) && mounted.current) {\n        doneRef.current?.()\n      }\n    },\n    [doneRef, mounted, transitionableChildren]\n  )\n\n  let register = useCallback(\n    (childId: ID) => {\n      let child = transitionableChildren.current.find(({ id }) => id === childId)\n      if (!child) {\n        transitionableChildren.current.push({ id: childId, state: TreeStates.Visible })\n      } else if (child.state !== TreeStates.Visible) {\n        child.state = TreeStates.Visible\n      }\n\n      return () => unregister(childId, RenderStrategy.Unmount)\n    },\n    [transitionableChildren, unregister]\n  )\n\n  return useMemo(\n    () => ({\n      children: transitionableChildren,\n      register,\n      unregister,\n    }),\n    [register, unregister, transitionableChildren]\n  )\n}\n\nfunction noop() {}\nlet eventNames: (keyof TransitionEvents)[] = [\n  'beforeEnter',\n  'afterEnter',\n  'beforeLeave',\n  'afterLeave',\n]\nfunction ensureEventHooksExist(events: TransitionEvents) {\n  return eventNames.reduce((all, eventName) => {\n    all[eventName] = events[eventName] || noop\n    return all\n  }, {} as Record<keyof TransitionEvents, () => void>)\n}\n\nfunction useEvents(events: TransitionEvents) {\n  let eventsRef = useRef(ensureEventHooksExist(events))\n\n  useEffect(() => {\n    eventsRef.current = ensureEventHooksExist(events)\n  }, [events])\n\n  return eventsRef\n}\n\n// ---\n\nlet DEFAULT_TRANSITION_CHILD_TAG = 'div' as const\ntype TransitionChildRenderPropArg = MutableRefObject<HTMLDivElement>\nlet TransitionChildRenderFeatures = Features.RenderStrategy\n\nfunction TransitionChild<TTag extends ElementType = typeof DEFAULT_TRANSITION_CHILD_TAG>(\n  props: TransitionChildProps<TTag>\n) {\n  let {\n    // Event \"handlers\"\n    beforeEnter,\n    afterEnter,\n    beforeLeave,\n    afterLeave,\n\n    // Class names\n    enter,\n    enterFrom,\n    enterTo,\n    leave,\n    leaveFrom,\n    leaveTo,\n\n    // @ts-expect-error\n    ...rest\n  } = props as typeof props\n  let container = useRef<HTMLElement | null>(null)\n  let [state, setState] = useState(TreeStates.Visible)\n  let strategy = rest.unmount ? RenderStrategy.Unmount : RenderStrategy.Hidden\n\n  let { show, appear } = useTransitionContext()\n  let { register, unregister } = useParentNesting()\n\n  let initial = useIsInitialRender()\n  let id = useId()\n\n  let isTransitioning = useRef(false)\n\n  let nesting = useNesting(() => {\n    // When all children have been unmounted we can only hide ourselves if and only if we are not\n    // transitioning ourserlves. Otherwise we would unmount before the transitions are finished.\n    if (!isTransitioning.current) {\n      setState(TreeStates.Hidden)\n      unregister(id)\n      events.current.afterLeave()\n    }\n  })\n\n  useIsoMorphicEffect(() => {\n    if (!id) return\n    return register(id)\n  }, [register, id])\n\n  useIsoMorphicEffect(() => {\n    // If we are in another mode than the Hidden mode then ignore\n    if (strategy !== RenderStrategy.Hidden) return\n    if (!id) return\n\n    // Make sure that we are visible\n    if (show && state !== TreeStates.Visible) {\n      setState(TreeStates.Visible)\n      return\n    }\n\n    match(state, {\n      [TreeStates.Hidden]: () => unregister(id),\n      [TreeStates.Visible]: () => register(id),\n    })\n  }, [state, id, register, unregister, show, strategy])\n\n  let enterClasses = useSplitClasses(enter)\n  let enterFromClasses = useSplitClasses(enterFrom)\n  let enterToClasses = useSplitClasses(enterTo)\n\n  let leaveClasses = useSplitClasses(leave)\n  let leaveFromClasses = useSplitClasses(leaveFrom)\n  let leaveToClasses = useSplitClasses(leaveTo)\n\n  let events = useEvents({ beforeEnter, afterEnter, beforeLeave, afterLeave })\n\n  useEffect(() => {\n    if (state === TreeStates.Visible && container.current === null) {\n      throw new Error('Did you forget to passthrough the `ref` to the actual DOM node?')\n    }\n  }, [container, state])\n\n  // Skipping initial transition\n  let skip = initial && !appear\n\n  useIsoMorphicEffect(() => {\n    let node = container.current\n    if (!node) return\n    if (skip) return\n\n    isTransitioning.current = true\n\n    if (show) events.current.beforeEnter()\n    if (!show) events.current.beforeLeave()\n\n    return show\n      ? transition(node, enterClasses, enterFromClasses, enterToClasses, reason => {\n          isTransitioning.current = false\n          if (reason === Reason.Finished) events.current.afterEnter()\n        })\n      : transition(node, leaveClasses, leaveFromClasses, leaveToClasses, reason => {\n          isTransitioning.current = false\n\n          if (reason !== Reason.Finished) return\n\n          // When we don't have children anymore we can safely unregister from the parent and hide\n          // ourselves.\n          if (!hasChildren(nesting)) {\n            setState(TreeStates.Hidden)\n            unregister(id)\n            events.current.afterLeave()\n          }\n        })\n  }, [\n    events,\n    id,\n    isTransitioning,\n    unregister,\n    nesting,\n    container,\n    skip,\n    show,\n    enterClasses,\n    enterFromClasses,\n    enterToClasses,\n    leaveClasses,\n    leaveFromClasses,\n    leaveToClasses,\n  ])\n\n  let propsBag = {}\n  let propsWeControl = { ref: container }\n  let passthroughProps = rest\n\n  return (\n    <NestingContext.Provider value={nesting}>\n      {render(\n        { ...passthroughProps, ...propsWeControl },\n        propsBag,\n        DEFAULT_TRANSITION_CHILD_TAG,\n        TransitionChildRenderFeatures,\n        state === TreeStates.Visible\n      )}\n    </NestingContext.Provider>\n  )\n}\n\nexport function Transition<TTag extends ElementType = typeof DEFAULT_TRANSITION_CHILD_TAG>(\n  props: TransitionChildProps<TTag> & { show: boolean; appear?: boolean }\n) {\n  // @ts-expect-error\n  let { show, appear = false, unmount, ...passthroughProps } = props as typeof props\n\n  if (![true, false].includes(show)) {\n    throw new Error('A <Transition /> is used but it is missing a `show={true | false}` prop.')\n  }\n\n  let [state, setState] = useState(show ? TreeStates.Visible : TreeStates.Hidden)\n\n  let nestingBag = useNesting(() => {\n    setState(TreeStates.Hidden)\n  })\n\n  let initial = useIsInitialRender()\n  let transitionBag = useMemo<TransitionContextValues>(\n    () => ({ show, appear: appear || !initial }),\n    [show, appear, initial]\n  )\n\n  useEffect(() => {\n    if (show) {\n      setState(TreeStates.Visible)\n    } else if (!hasChildren(nestingBag)) {\n      setState(TreeStates.Hidden)\n    }\n  }, [show, nestingBag])\n\n  let sharedProps = { unmount }\n  let propsBag = {}\n\n  return (\n    <NestingContext.Provider value={nestingBag}>\n      <TransitionContext.Provider value={transitionBag}>\n        {render(\n          {\n            ...sharedProps,\n            as: Fragment,\n            children: <TransitionChild {...sharedProps} {...passthroughProps} />,\n          },\n          propsBag,\n          Fragment,\n          TransitionChildRenderFeatures,\n          state === TreeStates.Visible\n        )}\n      </TransitionContext.Provider>\n    </NestingContext.Provider>\n  )\n}\n\nTransition.Child = TransitionChild\n","import { useState, useEffect } from 'react'\n\nimport { disposables } from '../utils/disposables'\n\nexport function useDisposables() {\n  // Using useState instead of useRef so that we can use the initializer function.\n  let [d] = useState(disposables)\n  useEffect(() => () => d.dispose(), [d])\n  return d\n}\n","import { useCallback } from 'react'\n\nexport function useSyncRefs<TType>(\n  ...refs: (React.MutableRefObject<TType> | ((instance: TType) => void) | null)[]\n) {\n  return useCallback(\n    (value: TType) => {\n      refs.forEach(ref => {\n        if (ref === null) return\n        if (typeof ref === 'function') return ref(value)\n        ref.current = value\n      })\n    },\n    [refs]\n  )\n}\n","// TODO: This must already exist somewhere, right? ðŸ¤”\n// Ref: https://www.w3.org/TR/uievents-key/#named-key-attribute-values\nexport enum Keys {\n  Space = ' ',\n  Enter = 'Enter',\n  Escape = 'Escape',\n  Backspace = 'Backspace',\n\n  ArrowUp = 'ArrowUp',\n  ArrowDown = 'ArrowDown',\n\n  Home = 'Home',\n  End = 'End',\n\n  PageUp = 'PageUp',\n  PageDown = 'PageDown',\n\n  Tab = 'Tab',\n}\n","function assertNever(x: never): never {\n  throw new Error('Unexpected object: ' + x)\n}\n\nexport enum Focus {\n  /** Focus the first non-disabled item. */\n  First,\n\n  /** Focus the previous non-disabled item. */\n  Previous,\n\n  /** Focus the next non-disabled item. */\n  Next,\n\n  /** Focus the last non-disabled item. */\n  Last,\n\n  /** Focus a specific item based on the `id` of the item. */\n  Specific,\n\n  /** Focus no items at all. */\n  Nothing,\n}\n\nexport function calculateActiveIndex<TItem>(\n  action: { focus: Focus.Specific; id: string } | { focus: Exclude<Focus, Focus.Specific> },\n  resolvers: {\n    resolveItems(): TItem[]\n    resolveActiveIndex(): number | null\n    resolveId(item: TItem): string\n    resolveDisabled(item: TItem): boolean\n  }\n) {\n  let items = resolvers.resolveItems()\n  if (items.length <= 0) return null\n\n  let currentActiveIndex = resolvers.resolveActiveIndex()\n  let activeIndex = currentActiveIndex ?? -1\n\n  let nextActiveIndex = (() => {\n    switch (action.focus) {\n      case Focus.First:\n        return items.findIndex(item => !resolvers.resolveDisabled(item))\n\n      case Focus.Previous: {\n        let idx = items\n          .slice()\n          .reverse()\n          .findIndex((item, idx, all) => {\n            if (activeIndex !== -1 && all.length - idx - 1 >= activeIndex) return false\n            return !resolvers.resolveDisabled(item)\n          })\n        if (idx === -1) return idx\n        return items.length - 1 - idx\n      }\n\n      case Focus.Next:\n        return items.findIndex((item, idx) => {\n          if (idx <= activeIndex) return false\n          return !resolvers.resolveDisabled(item)\n        })\n\n      case Focus.Last: {\n        let idx = items\n          .slice()\n          .reverse()\n          .findIndex(item => !resolvers.resolveDisabled(item))\n        if (idx === -1) return idx\n        return items.length - 1 - idx\n      }\n\n      case Focus.Specific:\n        return items.findIndex(item => resolvers.resolveId(item) === action.id)\n\n      case Focus.Nothing:\n        return null\n\n      default:\n        assertNever(action)\n    }\n  })()\n\n  return nextActiveIndex === -1 ? currentActiveIndex : nextActiveIndex\n}\n","export function resolvePropValue<TProperty, TBag>(property: TProperty, bag: TBag) {\n  if (property === undefined) return undefined\n  if (typeof property === 'function') return property(bag)\n  return property\n}\n","// See: https://github.com/facebook/react/issues/7711\n// See: https://github.com/facebook/react/pull/20612\n// See: https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#concept-fe-disabled (2.)\nexport function isDisabledReactIssue7711(element: Element): boolean {\n  let parent = element.parentElement\n  let legend = null\n\n  while (parent && !(parent instanceof HTMLFieldSetElement)) {\n    if (parent instanceof HTMLLegendElement) legend = parent\n    parent = parent.parentElement\n  }\n\n  let isParentDisabled = parent?.getAttribute('disabled') === '' ?? false\n  if (isParentDisabled && isFirstLegend(legend)) return false\n\n  return isParentDisabled\n}\n\nfunction isFirstLegend(element: HTMLLegendElement | null): boolean {\n  if (!element) return false\n\n  let previous = element.previousElementSibling\n\n  while (previous !== null) {\n    if (previous instanceof HTMLLegendElement) return false\n    previous = previous.previousElementSibling\n  }\n\n  return true\n}\n","// WAI-ARIA: https://www.w3.org/TR/wai-aria-practices-1.2/#menubutton\nimport React, {\n  createContext,\n  createRef,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  Fragment,\n\n  // Types\n  Dispatch,\n  ElementType,\n  KeyboardEvent as ReactKeyboardEvent,\n  MouseEvent as ReactMouseEvent,\n  MutableRefObject,\n  Ref,\n} from 'react'\n\nimport { Props } from '../../types'\nimport { match } from '../../utils/match'\nimport { forwardRefWithAs, render, Features, PropsForFeatures } from '../../utils/render'\nimport { disposables } from '../../utils/disposables'\nimport { useDisposables } from '../../hooks/use-disposables'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { useId } from '../../hooks/use-id'\nimport { Keys } from '../keyboard'\nimport { Focus, calculateActiveIndex } from '../../utils/calculate-active-index'\nimport { resolvePropValue } from '../../utils/resolve-prop-value'\nimport { isDisabledReactIssue7711 } from '../../utils/bugs'\n\nenum MenuStates {\n  Open,\n  Closed,\n}\n\ntype MenuItemDataRef = MutableRefObject<{ textValue?: string; disabled: boolean }>\n\ninterface StateDefinition {\n  menuState: MenuStates\n  buttonRef: MutableRefObject<HTMLButtonElement | null>\n  itemsRef: MutableRefObject<HTMLDivElement | null>\n  items: { id: string; dataRef: MenuItemDataRef }[]\n  searchQuery: string\n  activeItemIndex: number | null\n}\n\nenum ActionTypes {\n  OpenMenu,\n  CloseMenu,\n\n  GoToItem,\n  Search,\n  ClearSearch,\n\n  RegisterItem,\n  UnregisterItem,\n}\n\ntype Actions =\n  | { type: ActionTypes.CloseMenu }\n  | { type: ActionTypes.OpenMenu }\n  | { type: ActionTypes.GoToItem; focus: Focus.Specific; id: string }\n  | { type: ActionTypes.GoToItem; focus: Exclude<Focus, Focus.Specific> }\n  | { type: ActionTypes.Search; value: string }\n  | { type: ActionTypes.ClearSearch }\n  | { type: ActionTypes.RegisterItem; id: string; dataRef: MenuItemDataRef }\n  | { type: ActionTypes.UnregisterItem; id: string }\n\nlet reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.CloseMenu]: state => ({\n    ...state,\n    activeItemIndex: null,\n    menuState: MenuStates.Closed,\n  }),\n  [ActionTypes.OpenMenu]: state => ({ ...state, menuState: MenuStates.Open }),\n  [ActionTypes.GoToItem]: (state, action) => {\n    let activeItemIndex = calculateActiveIndex(action, {\n      resolveItems: () => state.items,\n      resolveActiveIndex: () => state.activeItemIndex,\n      resolveId: item => item.id,\n      resolveDisabled: item => item.dataRef.current.disabled,\n    })\n\n    if (state.searchQuery === '' && state.activeItemIndex === activeItemIndex) return state\n    return { ...state, searchQuery: '', activeItemIndex }\n  },\n  [ActionTypes.Search]: (state, action) => {\n    let searchQuery = state.searchQuery + action.value\n    let match = state.items.findIndex(\n      item =>\n        item.dataRef.current.textValue?.startsWith(searchQuery) && !item.dataRef.current.disabled\n    )\n\n    if (match === -1 || match === state.activeItemIndex) return { ...state, searchQuery }\n    return { ...state, searchQuery, activeItemIndex: match }\n  },\n  [ActionTypes.ClearSearch]: state => ({ ...state, searchQuery: '' }),\n  [ActionTypes.RegisterItem]: (state, action) => ({\n    ...state,\n    items: [...state.items, { id: action.id, dataRef: action.dataRef }],\n  }),\n  [ActionTypes.UnregisterItem]: (state, action) => {\n    let nextItems = state.items.slice()\n    let currentActiveItem = state.activeItemIndex !== null ? nextItems[state.activeItemIndex] : null\n\n    let idx = nextItems.findIndex(a => a.id === action.id)\n\n    if (idx !== -1) nextItems.splice(idx, 1)\n\n    return {\n      ...state,\n      items: nextItems,\n      activeItemIndex: (() => {\n        if (idx === state.activeItemIndex) return null\n        if (currentActiveItem === null) return null\n\n        // If we removed the item before the actual active index, then it would be out of sync. To\n        // fix this, we will find the correct (new) index position.\n        return nextItems.indexOf(currentActiveItem)\n      })(),\n    }\n  },\n}\n\nlet MenuContext = createContext<[StateDefinition, Dispatch<Actions>] | null>(null)\nMenuContext.displayName = 'MenuContext'\n\nfunction useMenuContext(component: string) {\n  let context = useContext(MenuContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <${Menu.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useMenuContext)\n    throw err\n  }\n  return context\n}\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\n// ---\n\nlet DEFAULT_MENU_TAG = Fragment\ninterface MenuRenderPropArg {\n  open: boolean\n}\n\nexport function Menu<TTag extends ElementType = typeof DEFAULT_MENU_TAG>(\n  props: Props<TTag, MenuRenderPropArg>\n) {\n  let reducerBag = useReducer(stateReducer, {\n    menuState: MenuStates.Closed,\n    buttonRef: createRef(),\n    itemsRef: createRef(),\n    items: [],\n    searchQuery: '',\n    activeItemIndex: null,\n  } as StateDefinition)\n  let [{ menuState, itemsRef, buttonRef }, dispatch] = reducerBag\n\n  useEffect(() => {\n    function handler(event: MouseEvent) {\n      let target = event.target as HTMLElement\n      let active = document.activeElement\n\n      if (menuState !== MenuStates.Open) return\n      if (buttonRef.current?.contains(target)) return\n\n      if (!itemsRef.current?.contains(target)) dispatch({ type: ActionTypes.CloseMenu })\n      if (active !== document.body && active?.contains(target)) return // Keep focus on newly clicked/focused element\n      if (!event.defaultPrevented) buttonRef.current?.focus({ preventScroll: true })\n    }\n\n    window.addEventListener('mousedown', handler)\n    return () => window.removeEventListener('mousedown', handler)\n  }, [menuState, itemsRef, buttonRef, dispatch])\n\n  let propsBag = useMemo(() => ({ open: menuState === MenuStates.Open }), [menuState])\n\n  return (\n    <MenuContext.Provider value={reducerBag}>\n      {render(props, propsBag, DEFAULT_MENU_TAG)}\n    </MenuContext.Provider>\n  )\n}\n\n// ---\n\nlet DEFAULT_BUTTON_TAG = 'button' as const\ninterface ButtonRenderPropArg {\n  open: boolean\n}\ntype ButtonPropsWeControl =\n  | 'id'\n  | 'type'\n  | 'aria-haspopup'\n  | 'aria-controls'\n  | 'aria-expanded'\n  | 'onKeyDown'\n  | 'onClick'\n\nlet Button = forwardRefWithAs(function Button<TTag extends ElementType = typeof DEFAULT_BUTTON_TAG>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: Ref<HTMLButtonElement>\n) {\n  let [state, dispatch] = useMenuContext([Menu.name, Button.name].join('.'))\n  let buttonRef = useSyncRefs(state.buttonRef, ref)\n\n  let id = `headlessui-menu-button-${useId()}`\n  let d = useDisposables()\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLButtonElement>) => {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenMenu })\n          d.nextFrame(() => {\n            state.itemsRef.current?.focus({ preventScroll: true })\n            dispatch({ type: ActionTypes.GoToItem, focus: Focus.First })\n          })\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenMenu })\n          d.nextFrame(() => {\n            state.itemsRef.current?.focus({ preventScroll: true })\n            dispatch({ type: ActionTypes.GoToItem, focus: Focus.Last })\n          })\n          break\n      }\n    },\n    [dispatch, state, d]\n  )\n\n  let handleClick = useCallback(\n    (event: ReactMouseEvent) => {\n      if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault()\n      if (props.disabled) return\n      if (state.menuState === MenuStates.Open) {\n        dispatch({ type: ActionTypes.CloseMenu })\n        d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n      } else {\n        event.preventDefault()\n        dispatch({ type: ActionTypes.OpenMenu })\n        d.nextFrame(() => state.itemsRef.current?.focus({ preventScroll: true }))\n      }\n    },\n    [dispatch, d, state, props.disabled]\n  )\n\n  let propsBag = useMemo(() => ({ open: state.menuState === MenuStates.Open }), [state])\n  let passthroughProps = props\n  let propsWeControl = {\n    ref: buttonRef,\n    id,\n    type: 'button',\n    'aria-haspopup': true,\n    'aria-controls': state.itemsRef.current?.id,\n    'aria-expanded': state.menuState === MenuStates.Open ? true : undefined,\n    onKeyDown: handleKeyDown,\n    onClick: handleClick,\n  }\n\n  return render({ ...passthroughProps, ...propsWeControl }, propsBag, DEFAULT_BUTTON_TAG)\n})\n\n// ---\n\nlet DEFAULT_ITEMS_TAG = 'div' as const\ninterface ItemsRenderPropArg {\n  open: boolean\n}\ntype ItemsPropsWeControl =\n  | 'aria-activedescendant'\n  | 'aria-labelledby'\n  | 'id'\n  | 'onKeyDown'\n  | 'role'\n  | 'tabIndex'\n\nlet ItemsRenderFeatures = Features.RenderStrategy | Features.Static\n\nlet Items = forwardRefWithAs(function Items<TTag extends ElementType = typeof DEFAULT_ITEMS_TAG>(\n  props: Props<TTag, ItemsRenderPropArg, ItemsPropsWeControl> &\n    PropsForFeatures<typeof ItemsRenderFeatures>,\n  ref: Ref<HTMLDivElement>\n) {\n  let [state, dispatch] = useMenuContext([Menu.name, Items.name].join('.'))\n  let itemsRef = useSyncRefs(state.itemsRef, ref)\n\n  let id = `headlessui-menu-items-${useId()}`\n  let searchDisposables = useDisposables()\n\n  useIsoMorphicEffect(() => {\n    let container = state.itemsRef.current\n    if (!container) return\n    if (state.menuState !== MenuStates.Open) return\n\n    let walker = document.createTreeWalker(container, NodeFilter.SHOW_ELEMENT, {\n      acceptNode(node: HTMLElement) {\n        if (node.getAttribute('role') === 'menuitem') return NodeFilter.FILTER_REJECT\n        if (node.hasAttribute('role')) return NodeFilter.FILTER_SKIP\n        return NodeFilter.FILTER_ACCEPT\n      },\n    })\n\n    while (walker.nextNode()) {\n      ;(walker.currentNode as HTMLElement).setAttribute('role', 'none')\n    }\n  })\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLDivElement>) => {\n      searchDisposables.dispose()\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (state.searchQuery !== '') {\n            event.preventDefault()\n            return dispatch({ type: ActionTypes.Search, value: event.key })\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseMenu })\n          if (state.activeItemIndex !== null) {\n            let { id } = state.items[state.activeItemIndex]\n            document.getElementById(id)?.click()\n          }\n          disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n          break\n\n        case Keys.ArrowDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Next })\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Previous })\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.First })\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Last })\n\n        case Keys.Escape:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseMenu })\n          disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n          break\n\n        case Keys.Tab:\n          return event.preventDefault()\n\n        default:\n          if (event.key.length === 1) {\n            dispatch({ type: ActionTypes.Search, value: event.key })\n            searchDisposables.setTimeout(() => dispatch({ type: ActionTypes.ClearSearch }), 350)\n          }\n          break\n      }\n    },\n    [dispatch, searchDisposables, state]\n  )\n\n  let propsBag = useMemo(() => ({ open: state.menuState === MenuStates.Open }), [state])\n  let propsWeControl = {\n    'aria-activedescendant':\n      state.activeItemIndex === null ? undefined : state.items[state.activeItemIndex]?.id,\n    'aria-labelledby': state.buttonRef.current?.id,\n    id,\n    onKeyDown: handleKeyDown,\n    role: 'menu',\n    tabIndex: 0,\n    ref: itemsRef,\n  }\n  let passthroughProps = props\n\n  return render(\n    { ...passthroughProps, ...propsWeControl },\n    propsBag,\n    DEFAULT_ITEMS_TAG,\n    ItemsRenderFeatures,\n    state.menuState === MenuStates.Open\n  )\n})\n\n// ---\n\nlet DEFAULT_ITEM_TAG = Fragment\ninterface ItemRenderPropArg {\n  active: boolean\n  disabled: boolean\n}\ntype MenuItemPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-disabled'\n  | 'onPointerLeave'\n  | 'onPointerMove'\n  | 'onMouseLeave'\n  | 'onMouseMove'\n  | 'onFocus'\n\nfunction Item<TTag extends ElementType = typeof DEFAULT_ITEM_TAG>(\n  props: Props<TTag, ItemRenderPropArg, MenuItemPropsWeControl | 'className'> & {\n    disabled?: boolean\n    onClick?: (event: { preventDefault: Function }) => void\n\n    // Special treatment, can either be a string or a function that resolves to a string\n    className?: ((bag: ItemRenderPropArg) => string) | string\n  }\n) {\n  let { disabled = false, className, onClick, ...passthroughProps } = props\n  let [state, dispatch] = useMenuContext([Menu.name, Item.name].join('.'))\n  let id = `headlessui-menu-item-${useId()}`\n  let active = state.activeItemIndex !== null ? state.items[state.activeItemIndex].id === id : false\n\n  useIsoMorphicEffect(() => {\n    if (state.menuState !== MenuStates.Open) return\n    if (!active) return\n    let d = disposables()\n    d.nextFrame(() => document.getElementById(id)?.scrollIntoView?.({ block: 'nearest' }))\n    return d.dispose\n  }, [id, active, state.menuState])\n\n  let bag = useRef<MenuItemDataRef['current']>({ disabled })\n\n  useIsoMorphicEffect(() => {\n    bag.current.disabled = disabled\n  }, [bag, disabled])\n\n  useIsoMorphicEffect(() => {\n    bag.current.textValue = document.getElementById(id)?.textContent?.toLowerCase()\n  }, [bag, id])\n\n  useIsoMorphicEffect(() => {\n    dispatch({ type: ActionTypes.RegisterItem, id, dataRef: bag })\n    return () => dispatch({ type: ActionTypes.UnregisterItem, id })\n  }, [bag, id])\n\n  let handleClick = useCallback(\n    (event: MouseEvent) => {\n      if (disabled) return event.preventDefault()\n      dispatch({ type: ActionTypes.CloseMenu })\n      disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n      if (onClick) return onClick(event)\n    },\n    [dispatch, state.buttonRef, disabled, onClick]\n  )\n\n  let handleFocus = useCallback(() => {\n    if (disabled) return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Nothing })\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.Specific, id })\n  }, [disabled, id, dispatch])\n\n  let handleMove = useCallback(() => {\n    if (disabled) return\n    if (active) return\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.Specific, id })\n  }, [disabled, active, id, dispatch])\n\n  let handleLeave = useCallback(() => {\n    if (disabled) return\n    if (!active) return\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.Nothing })\n  }, [disabled, active, dispatch])\n\n  let propsBag = useMemo(() => ({ active, disabled }), [active, disabled])\n  let propsWeControl = {\n    id,\n    role: 'menuitem',\n    tabIndex: -1,\n    className: resolvePropValue(className, propsBag),\n    'aria-disabled': disabled === true ? true : undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handleMove,\n    onMouseMove: handleMove,\n    onPointerLeave: handleLeave,\n    onMouseLeave: handleLeave,\n  }\n\n  return render({ ...passthroughProps, ...propsWeControl }, propsBag, DEFAULT_ITEM_TAG)\n}\n\n// ---\n\nMenu.Button = Button\nMenu.Items = Items\nMenu.Item = Item\n","import { useState, useRef } from 'react'\nimport { useIsoMorphicEffect } from './use-iso-morphic-effect'\n\nexport function useComputed<T>(cb: () => T, dependencies: React.DependencyList) {\n  let [value, setValue] = useState(cb)\n  let cbRef = useRef(cb)\n  useIsoMorphicEffect(() => {\n    cbRef.current = cb\n  }, [cb])\n  useIsoMorphicEffect(() => setValue(cbRef.current), [cbRef, setValue, ...dependencies])\n  return value\n}\n","import React, {\n  createContext,\n  createRef,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  Fragment,\n\n  // Types\n  Dispatch,\n  ElementType,\n  KeyboardEvent as ReactKeyboardEvent,\n  MouseEvent as ReactMouseEvent,\n  MutableRefObject,\n  Ref,\n} from 'react'\n\nimport { useDisposables } from '../../hooks/use-disposables'\nimport { useId } from '../../hooks/use-id'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\nimport { useComputed } from '../../hooks/use-computed'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { Props } from '../../types'\nimport { Features, forwardRefWithAs, PropsForFeatures, render } from '../../utils/render'\nimport { match } from '../../utils/match'\nimport { disposables } from '../../utils/disposables'\nimport { Keys } from '../keyboard'\nimport { Focus, calculateActiveIndex } from '../../utils/calculate-active-index'\nimport { resolvePropValue } from '../../utils/resolve-prop-value'\nimport { isDisabledReactIssue7711 } from '../../utils/bugs'\n\nenum ListboxStates {\n  Open,\n  Closed,\n}\n\ntype ListboxOptionDataRef = MutableRefObject<{\n  textValue?: string\n  disabled: boolean\n  value: unknown\n}>\n\ninterface StateDefinition {\n  listboxState: ListboxStates\n  propsRef: MutableRefObject<{ value: unknown; onChange(value: unknown): void }>\n  labelRef: MutableRefObject<HTMLLabelElement | null>\n  buttonRef: MutableRefObject<HTMLButtonElement | null>\n  optionsRef: MutableRefObject<HTMLUListElement | null>\n  disabled: boolean\n  options: { id: string; dataRef: ListboxOptionDataRef }[]\n  searchQuery: string\n  activeOptionIndex: number | null\n}\n\nenum ActionTypes {\n  OpenListbox,\n  CloseListbox,\n\n  SetDisabled,\n\n  GoToOption,\n  Search,\n  ClearSearch,\n\n  RegisterOption,\n  UnregisterOption,\n}\n\ntype Actions =\n  | { type: ActionTypes.CloseListbox }\n  | { type: ActionTypes.OpenListbox }\n  | { type: ActionTypes.SetDisabled; disabled: boolean }\n  | { type: ActionTypes.GoToOption; focus: Focus.Specific; id: string }\n  | { type: ActionTypes.GoToOption; focus: Exclude<Focus, Focus.Specific> }\n  | { type: ActionTypes.Search; value: string }\n  | { type: ActionTypes.ClearSearch }\n  | { type: ActionTypes.RegisterOption; id: string; dataRef: ListboxOptionDataRef }\n  | { type: ActionTypes.UnregisterOption; id: string }\n\nlet reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.CloseListbox](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n    return { ...state, activeOptionIndex: null, listboxState: ListboxStates.Closed }\n  },\n  [ActionTypes.OpenListbox](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Open) return state\n    return { ...state, listboxState: ListboxStates.Open }\n  },\n  [ActionTypes.SetDisabled](state, action) {\n    if (state.disabled === action.disabled) return state\n    return { ...state, disabled: action.disabled }\n  },\n  [ActionTypes.GoToOption](state, action) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n\n    let activeOptionIndex = calculateActiveIndex(action, {\n      resolveItems: () => state.options,\n      resolveActiveIndex: () => state.activeOptionIndex,\n      resolveId: item => item.id,\n      resolveDisabled: item => item.dataRef.current.disabled,\n    })\n\n    if (state.searchQuery === '' && state.activeOptionIndex === activeOptionIndex) return state\n    return { ...state, searchQuery: '', activeOptionIndex }\n  },\n  [ActionTypes.Search]: (state, action) => {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n\n    let searchQuery = state.searchQuery + action.value\n    let match = state.options.findIndex(\n      option =>\n        !option.dataRef.current.disabled &&\n        option.dataRef.current.textValue?.startsWith(searchQuery)\n    )\n\n    if (match === -1 || match === state.activeOptionIndex) return { ...state, searchQuery }\n    return { ...state, searchQuery, activeOptionIndex: match }\n  },\n  [ActionTypes.ClearSearch](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n    if (state.searchQuery === '') return state\n    return { ...state, searchQuery: '' }\n  },\n  [ActionTypes.RegisterOption]: (state, action) => ({\n    ...state,\n    options: [...state.options, { id: action.id, dataRef: action.dataRef }],\n  }),\n  [ActionTypes.UnregisterOption]: (state, action) => {\n    let nextOptions = state.options.slice()\n    let currentActiveOption =\n      state.activeOptionIndex !== null ? nextOptions[state.activeOptionIndex] : null\n\n    let idx = nextOptions.findIndex(a => a.id === action.id)\n\n    if (idx !== -1) nextOptions.splice(idx, 1)\n\n    return {\n      ...state,\n      options: nextOptions,\n      activeOptionIndex: (() => {\n        if (idx === state.activeOptionIndex) return null\n        if (currentActiveOption === null) return null\n\n        // If we removed the option before the actual active index, then it would be out of sync. To\n        // fix this, we will find the correct (new) index position.\n        return nextOptions.indexOf(currentActiveOption)\n      })(),\n    }\n  },\n}\n\nlet ListboxContext = createContext<[StateDefinition, Dispatch<Actions>] | null>(null)\nListboxContext.displayName = 'ListboxContext'\n\nfunction useListboxContext(component: string) {\n  let context = useContext(ListboxContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <${Listbox.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useListboxContext)\n    throw err\n  }\n  return context\n}\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\n// ---\n\nlet DEFAULT_LISTBOX_TAG = Fragment\ninterface ListboxRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\n\nexport function Listbox<TTag extends ElementType = typeof DEFAULT_LISTBOX_TAG, TType = string>(\n  props: Props<TTag, ListboxRenderPropArg, 'value' | 'onChange'> & {\n    value: TType\n    onChange(value: TType): void\n    disabled?: boolean\n  }\n) {\n  let { value, onChange, disabled = false, ...passThroughProps } = props\n  let d = useDisposables()\n  let reducerBag = useReducer(stateReducer, {\n    listboxState: ListboxStates.Closed,\n    propsRef: { current: { value, onChange } },\n    labelRef: createRef(),\n    buttonRef: createRef(),\n    optionsRef: createRef(),\n    disabled,\n    options: [],\n    searchQuery: '',\n    activeOptionIndex: null,\n  } as StateDefinition)\n  let [{ listboxState, propsRef, optionsRef, buttonRef }, dispatch] = reducerBag\n\n  useIsoMorphicEffect(() => {\n    propsRef.current.value = value\n  }, [value, propsRef])\n  useIsoMorphicEffect(() => {\n    propsRef.current.onChange = onChange\n  }, [onChange, propsRef])\n  useIsoMorphicEffect(() => dispatch({ type: ActionTypes.SetDisabled, disabled }), [disabled])\n\n  useEffect(() => {\n    function handler(event: MouseEvent) {\n      let target = event.target as HTMLElement\n      let active = document.activeElement\n\n      if (listboxState !== ListboxStates.Open) return\n      if (buttonRef.current?.contains(target)) return\n\n      if (!optionsRef.current?.contains(target)) dispatch({ type: ActionTypes.CloseListbox })\n      if (active !== document.body && active?.contains(target)) return // Keep focus on newly clicked/focused element\n      if (!event.defaultPrevented) buttonRef.current?.focus({ preventScroll: true })\n    }\n\n    window.addEventListener('mousedown', handler)\n    return () => window.removeEventListener('mousedown', handler)\n  }, [listboxState, optionsRef, buttonRef, d, dispatch])\n\n  let propsBag = useMemo<ListboxRenderPropArg>(\n    () => ({ open: listboxState === ListboxStates.Open, disabled }),\n    [listboxState, disabled]\n  )\n\n  return (\n    <ListboxContext.Provider value={reducerBag}>\n      {render(passThroughProps, propsBag, DEFAULT_LISTBOX_TAG)}\n    </ListboxContext.Provider>\n  )\n}\n\n// ---\n\nlet DEFAULT_BUTTON_TAG = 'button' as const\ninterface ButtonRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\ntype ButtonPropsWeControl =\n  | 'id'\n  | 'type'\n  | 'aria-haspopup'\n  | 'aria-controls'\n  | 'aria-expanded'\n  | 'aria-labelledby'\n  | 'disabled'\n  | 'onKeyDown'\n  | 'onClick'\n\nlet Button = forwardRefWithAs(function Button<TTag extends ElementType = typeof DEFAULT_BUTTON_TAG>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: Ref<HTMLButtonElement>\n) {\n  let [state, dispatch] = useListboxContext([Listbox.name, Button.name].join('.'))\n  let buttonRef = useSyncRefs(state.buttonRef, ref)\n\n  let id = `headlessui-listbox-button-${useId()}`\n  let d = useDisposables()\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLButtonElement>) => {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            state.optionsRef.current?.focus({ preventScroll: true })\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n          })\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            state.optionsRef.current?.focus({ preventScroll: true })\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n          })\n          break\n      }\n    },\n    [dispatch, state, d]\n  )\n\n  let handleClick = useCallback(\n    (event: ReactMouseEvent) => {\n      if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault()\n      if (state.listboxState === ListboxStates.Open) {\n        dispatch({ type: ActionTypes.CloseListbox })\n        d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n      } else {\n        event.preventDefault()\n        dispatch({ type: ActionTypes.OpenListbox })\n        d.nextFrame(() => state.optionsRef.current?.focus({ preventScroll: true }))\n      }\n    },\n    [dispatch, d, state]\n  )\n\n  let labelledby = useComputed(() => {\n    if (!state.labelRef.current) return undefined\n    return [state.labelRef.current.id, id].join(' ')\n  }, [state.labelRef.current, id])\n\n  let propsBag = useMemo<ButtonRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open, disabled: state.disabled }),\n    [state]\n  )\n  let passthroughProps = props\n  let propsWeControl = {\n    ref: buttonRef,\n    id,\n    type: 'button',\n    'aria-haspopup': true,\n    'aria-controls': state.optionsRef.current?.id,\n    'aria-expanded': state.listboxState === ListboxStates.Open ? true : undefined,\n    'aria-labelledby': labelledby,\n    disabled: state.disabled,\n    onKeyDown: handleKeyDown,\n    onClick: handleClick,\n  }\n\n  return render({ ...passthroughProps, ...propsWeControl }, propsBag, DEFAULT_BUTTON_TAG)\n})\n\n// ---\n\nlet DEFAULT_LABEL_TAG = 'label' as const\ninterface LabelRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\ntype LabelPropsWeControl = 'id' | 'ref' | 'onClick'\n\nfunction Label<TTag extends ElementType = typeof DEFAULT_LABEL_TAG>(\n  props: Props<TTag, LabelRenderPropArg, LabelPropsWeControl>\n) {\n  let [state] = useListboxContext([Listbox.name, Label.name].join('.'))\n  let id = `headlessui-listbox-label-${useId()}`\n\n  let handleClick = useCallback(() => state.buttonRef.current?.focus({ preventScroll: true }), [\n    state.buttonRef,\n  ])\n\n  let propsBag = useMemo<LabelRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open, disabled: state.disabled }),\n    [state]\n  )\n  let propsWeControl = { ref: state.labelRef, id, onClick: handleClick }\n  return render({ ...props, ...propsWeControl }, propsBag, DEFAULT_LABEL_TAG)\n}\n\n// ---\n\nlet DEFAULT_OPTIONS_TAG = 'ul' as const\ninterface OptionsRenderPropArg {\n  open: boolean\n}\ntype OptionsPropsWeControl =\n  | 'aria-activedescendant'\n  | 'aria-labelledby'\n  | 'id'\n  | 'onKeyDown'\n  | 'role'\n  | 'tabIndex'\n\nlet OptionsRenderFeatures = Features.RenderStrategy | Features.Static\n\nlet Options = forwardRefWithAs(function Options<\n  TTag extends ElementType = typeof DEFAULT_OPTIONS_TAG\n>(\n  props: Props<TTag, OptionsRenderPropArg, OptionsPropsWeControl> &\n    PropsForFeatures<typeof OptionsRenderFeatures>,\n  ref: Ref<HTMLUListElement>\n) {\n  let [state, dispatch] = useListboxContext([Listbox.name, Options.name].join('.'))\n  let optionsRef = useSyncRefs(state.optionsRef, ref)\n\n  let id = `headlessui-listbox-options-${useId()}`\n  let d = useDisposables()\n  let searchDisposables = useDisposables()\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLUListElement>) => {\n      searchDisposables.dispose()\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (state.searchQuery !== '') {\n            event.preventDefault()\n            return dispatch({ type: ActionTypes.Search, value: event.key })\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseListbox })\n          if (state.activeOptionIndex !== null) {\n            let { dataRef } = state.options[state.activeOptionIndex]\n            state.propsRef.current.onChange(dataRef.current.value)\n          }\n          disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n          break\n\n        case Keys.ArrowDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Next })\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Previous })\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n\n        case Keys.Escape:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.CloseListbox })\n          return d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n\n        case Keys.Tab:\n          return event.preventDefault()\n\n        default:\n          if (event.key.length === 1) {\n            dispatch({ type: ActionTypes.Search, value: event.key })\n            searchDisposables.setTimeout(() => dispatch({ type: ActionTypes.ClearSearch }), 350)\n          }\n          break\n      }\n    },\n    [d, dispatch, searchDisposables, state]\n  )\n\n  let labelledby = useComputed(() => state.labelRef.current?.id ?? state.buttonRef.current?.id, [\n    state.labelRef.current,\n    state.buttonRef.current,\n  ])\n\n  let propsBag = useMemo<OptionsRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open }),\n    [state]\n  )\n  let propsWeControl = {\n    'aria-activedescendant':\n      state.activeOptionIndex === null ? undefined : state.options[state.activeOptionIndex]?.id,\n    'aria-labelledby': labelledby,\n    id,\n    onKeyDown: handleKeyDown,\n    role: 'listbox',\n    tabIndex: 0,\n    ref: optionsRef,\n  }\n  let passthroughProps = props\n\n  return render(\n    { ...passthroughProps, ...propsWeControl },\n    propsBag,\n    DEFAULT_OPTIONS_TAG,\n    OptionsRenderFeatures,\n    state.listboxState === ListboxStates.Open\n  )\n})\n\n// ---\n\nlet DEFAULT_OPTION_TAG = 'li' as const\ninterface OptionRenderPropArg {\n  active: boolean\n  selected: boolean\n  disabled: boolean\n}\ntype ListboxOptionPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-disabled'\n  | 'aria-selected'\n  | 'onPointerLeave'\n  | 'onMouseLeave'\n  | 'onPointerMove'\n  | 'onMouseMove'\n  | 'onFocus'\n\nfunction Option<\n  TTag extends ElementType = typeof DEFAULT_OPTION_TAG,\n  // TODO: One day we will be able to infer this type from the generic in Listbox itself.\n  // But today is not that day..\n  TType = Parameters<typeof Listbox>[0]['value']\n>(\n  props: Props<TTag, OptionRenderPropArg, ListboxOptionPropsWeControl | 'className' | 'value'> & {\n    disabled?: boolean\n    value: TType\n\n    // Special treatment, can either be a string or a function that resolves to a string\n    className?: ((bag: OptionRenderPropArg) => string) | string\n  }\n) {\n  let { disabled = false, value, className, ...passthroughProps } = props\n  let [state, dispatch] = useListboxContext([Listbox.name, Option.name].join('.'))\n  let id = `headlessui-listbox-option-${useId()}`\n  let active =\n    state.activeOptionIndex !== null ? state.options[state.activeOptionIndex].id === id : false\n  let selected = state.propsRef.current.value === value\n\n  let bag = useRef<ListboxOptionDataRef['current']>({ disabled, value })\n\n  useIsoMorphicEffect(() => {\n    bag.current.disabled = disabled\n  }, [bag, disabled])\n  useIsoMorphicEffect(() => {\n    bag.current.value = value\n  }, [bag, value])\n  useIsoMorphicEffect(() => {\n    bag.current.textValue = document.getElementById(id)?.textContent?.toLowerCase()\n  }, [bag, id])\n\n  let select = useCallback(() => state.propsRef.current.onChange(value), [state.propsRef, value])\n\n  useIsoMorphicEffect(() => {\n    dispatch({ type: ActionTypes.RegisterOption, id, dataRef: bag })\n    return () => dispatch({ type: ActionTypes.UnregisterOption, id })\n  }, [bag, id])\n\n  useIsoMorphicEffect(() => {\n    if (state.listboxState !== ListboxStates.Open) return\n    if (!selected) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n    document.getElementById(id)?.focus?.()\n  }, [state.listboxState])\n\n  useIsoMorphicEffect(() => {\n    if (state.listboxState !== ListboxStates.Open) return\n    if (!active) return\n    let d = disposables()\n    d.nextFrame(() => document.getElementById(id)?.scrollIntoView?.({ block: 'nearest' }))\n    return d.dispose\n  }, [id, active, state.listboxState])\n\n  let handleClick = useCallback(\n    (event: { preventDefault: Function }) => {\n      if (disabled) return event.preventDefault()\n      select()\n      dispatch({ type: ActionTypes.CloseListbox })\n      disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n    },\n    [dispatch, state.buttonRef, disabled, select]\n  )\n\n  let handleFocus = useCallback(() => {\n    if (disabled) return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, id, dispatch])\n\n  let handleMove = useCallback(() => {\n    if (disabled) return\n    if (active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, active, id, dispatch])\n\n  let handleLeave = useCallback(() => {\n    if (disabled) return\n    if (!active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n  }, [disabled, active, dispatch])\n\n  let propsBag = useMemo(() => ({ active, selected, disabled }), [active, selected, disabled])\n  let propsWeControl = {\n    id,\n    role: 'option',\n    tabIndex: -1,\n    className: resolvePropValue(className, propsBag),\n    'aria-disabled': disabled === true ? true : undefined,\n    'aria-selected': selected === true ? true : undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handleMove,\n    onMouseMove: handleMove,\n    onPointerLeave: handleLeave,\n    onMouseLeave: handleLeave,\n  }\n\n  return render({ ...passthroughProps, ...propsWeControl }, propsBag, DEFAULT_OPTION_TAG)\n}\n\n// ---\n\nListbox.Button = Button\nListbox.Label = Label\nListbox.Options = Options\nListbox.Option = Option\n","import React, {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n  Fragment,\n\n  // Types\n  ElementType,\n  KeyboardEvent as ReactKeyboardEvent,\n  MouseEvent as ReactMouseEvent,\n} from 'react'\n\nimport { Props } from '../../types'\nimport { render } from '../../utils/render'\nimport { useId } from '../../hooks/use-id'\nimport { Keys } from '../keyboard'\nimport { resolvePropValue } from '../../utils/resolve-prop-value'\nimport { isDisabledReactIssue7711 } from '../../utils/bugs'\n\ninterface StateDefinition {\n  switch: HTMLButtonElement | null\n  label: HTMLLabelElement | null\n\n  setSwitch(element: HTMLButtonElement): void\n  setLabel(element: HTMLLabelElement): void\n}\n\nlet GroupContext = createContext<StateDefinition | null>(null)\nGroupContext.displayName = 'GroupContext'\n\nfunction useGroupContext(component: string) {\n  let context = useContext(GroupContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <Switch.Group /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useGroupContext)\n    throw err\n  }\n  return context\n}\n\n// ---\n\nlet DEFAULT_GROUP_TAG = Fragment\n\nfunction Group<TTag extends ElementType = typeof DEFAULT_GROUP_TAG>(props: Props<TTag>) {\n  let [switchElement, setSwitchElement] = useState<HTMLButtonElement | null>(null)\n  let [labelElement, setLabelElement] = useState<HTMLLabelElement | null>(null)\n\n  let context = useMemo<StateDefinition>(\n    () => ({\n      switch: switchElement,\n      label: labelElement,\n      setSwitch: setSwitchElement,\n      setLabel: setLabelElement,\n    }),\n    [switchElement, setSwitchElement, labelElement, setLabelElement]\n  )\n\n  return (\n    <GroupContext.Provider value={context}>\n      {render(props, {}, DEFAULT_GROUP_TAG)}\n    </GroupContext.Provider>\n  )\n}\n\n// ---\n\nlet DEFAULT_SWITCH_TAG = 'button' as const\ninterface SwitchRenderPropArg {\n  checked: boolean\n}\ntype SwitchPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-checked'\n  | 'onClick'\n  | 'onKeyUp'\n  | 'onKeyPress'\n\nexport function Switch<TTag extends ElementType = typeof DEFAULT_SWITCH_TAG>(\n  props: Props<\n    TTag,\n    SwitchRenderPropArg,\n    SwitchPropsWeControl | 'checked' | 'onChange' | 'className'\n  > & {\n    checked: boolean\n    onChange(checked: boolean): void\n\n    // Special treatment, can either be a string or a function that resolves to a string\n    className?: ((bag: SwitchRenderPropArg) => string) | string\n  }\n) {\n  let { checked, onChange, className, ...passThroughProps } = props\n  let id = `headlessui-switch-${useId()}`\n  let groupContext = useContext(GroupContext)\n\n  let toggle = useCallback(() => onChange(!checked), [onChange, checked])\n  let handleClick = useCallback(\n    (event: ReactMouseEvent) => {\n      if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault()\n      event.preventDefault()\n      toggle()\n    },\n    [toggle]\n  )\n  let handleKeyUp = useCallback(\n    (event: ReactKeyboardEvent<HTMLElement>) => {\n      if (event.key !== Keys.Tab) event.preventDefault()\n      if (event.key === Keys.Space) toggle()\n    },\n    [toggle]\n  )\n\n  // This is needed so that we can \"cancel\" the click event when we use the `Enter` key on a button.\n  let handleKeyPress = useCallback(\n    (event: ReactKeyboardEvent<HTMLElement>) => event.preventDefault(),\n    []\n  )\n\n  let propsBag = useMemo<SwitchRenderPropArg>(() => ({ checked }), [checked])\n  let propsWeControl = {\n    id,\n    ref: groupContext === null ? undefined : groupContext.setSwitch,\n    role: 'switch',\n    tabIndex: 0,\n    className: resolvePropValue(className, propsBag),\n    'aria-checked': checked,\n    'aria-labelledby': groupContext?.label?.id,\n    onClick: handleClick,\n    onKeyUp: handleKeyUp,\n    onKeyPress: handleKeyPress,\n  }\n\n  if (passThroughProps.as === 'button') {\n    Object.assign(propsWeControl, { type: 'button' })\n  }\n\n  return render({ ...passThroughProps, ...propsWeControl }, propsBag, DEFAULT_SWITCH_TAG)\n}\n\n// ---\n\nlet DEFAULT_LABEL_TAG = 'label' as const\ninterface LabelRenderPropArg {}\ntype LabelPropsWeControl = 'id' | 'ref' | 'onClick'\n\nfunction Label<TTag extends ElementType = typeof DEFAULT_LABEL_TAG>(\n  props: Props<TTag, LabelRenderPropArg, LabelPropsWeControl>\n) {\n  let state = useGroupContext([Switch.name, Label.name].join('.'))\n  let id = `headlessui-switch-label-${useId()}`\n\n  let handleClick = useCallback(() => {\n    if (!state.switch) return\n    state.switch.click()\n    state.switch.focus({ preventScroll: true })\n  }, [state.switch])\n\n  let propsWeControl = { ref: state.setLabel, id, onClick: handleClick }\n  return render({ ...props, ...propsWeControl }, {}, DEFAULT_LABEL_TAG)\n}\n\n// ---\n\nSwitch.Group = Group\nSwitch.Label = Label\n"],"names":["useIsoMorphicEffect","window","useLayoutEffect","useEffect","state","serverHandoffComplete","id","generateId","useId","useState","setId","undefined","useIsInitialRender","initial","useRef","current","match","value","lookup","returnValue","args","error","Error","Object","keys","map","key","join","captureStackTrace","useIsMounted","mounted","Features","RenderStrategy","render","props","propsBag","defaultTag","features","visible","_render","featureFlags","None","Static","isStatic","rest","unmount","strategy","Unmount","Hidden","hidden","style","display","bag","tag","omit","as","Component","children","refName","passThroughProps","refRelatedProps","ref","resolvedChildren","Fragment","length","Array","isArray","err","isValidElement","cloneElement","assign","mergeEventFunctions","compact","createElement","existingProps","functionsToMerge","clone","func","event","defaultPrevented","forwardRefWithAs","component","forwardRef","object","keysToOmit","once","cb","called","disposables","api","requestAnimationFrame","raf","add","cancelAnimationFrame","nextFrame","setTimeout","timer","clearTimeout","push","dispose","splice","addClasses","node","classes","classList","removeClasses","remove","Reason","waitForTransition","done","d","getComputedStyle","transitionDuration","transitionDelay","split","filter","Boolean","v","includes","parseFloat","sort","a","z","resolvedValue","durationMs","delaysMs","Finished","Cancelled","transition","base","from","to","_done","reason","useSplitClasses","useMemo","className","trim","TransitionContext","createContext","displayName","TreeStates","useTransitionContext","context","useContext","useParentNesting","NestingContext","hasChildren","Visible","useNesting","doneRef","transitionableChildren","unregister","useCallback","childId","idx","findIndex","register","child","find","noop","eventNames","ensureEventHooksExist","events","reduce","all","eventName","useEvents","eventsRef","DEFAULT_TRANSITION_CHILD_TAG","TransitionChildRenderFeatures","TransitionChild","beforeEnter","afterEnter","beforeLeave","afterLeave","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","container","setState","show","appear","isTransitioning","nesting","enterClasses","enterFromClasses","enterToClasses","leaveClasses","leaveFromClasses","leaveToClasses","skip","propsWeControl","passthroughProps","React","Provider","Transition","nestingBag","transitionBag","sharedProps","Child","useDisposables","useSyncRefs","refs","forEach","Keys","assertNever","x","Focus","calculateActiveIndex","action","resolvers","items","resolveItems","currentActiveIndex","resolveActiveIndex","activeIndex","nextActiveIndex","focus","First","item","resolveDisabled","Previous","slice","reverse","Next","Last","Specific","resolveId","Nothing","resolvePropValue","property","isDisabledReactIssue7711","element","parent","parentElement","legend","HTMLFieldSetElement","HTMLLegendElement","isParentDisabled","getAttribute","isFirstLegend","previous","previousElementSibling","MenuStates","ActionTypes","reducers","CloseMenu","activeItemIndex","menuState","Closed","OpenMenu","Open","GoToItem","dataRef","disabled","searchQuery","Search","textValue","startsWith","ClearSearch","RegisterItem","UnregisterItem","nextItems","currentActiveItem","indexOf","MenuContext","useMenuContext","Menu","name","stateReducer","type","DEFAULT_MENU_TAG","reducerBag","useReducer","buttonRef","createRef","itemsRef","dispatch","handler","target","active","document","activeElement","contains","body","preventScroll","addEventListener","removeEventListener","open","DEFAULT_BUTTON_TAG","Button","handleKeyDown","Space","Enter","ArrowDown","preventDefault","ArrowUp","handleClick","currentTarget","onKeyDown","onClick","DEFAULT_ITEMS_TAG","ItemsRenderFeatures","Items","searchDisposables","walker","createTreeWalker","NodeFilter","SHOW_ELEMENT","acceptNode","FILTER_REJECT","hasAttribute","FILTER_SKIP","FILTER_ACCEPT","nextNode","currentNode","setAttribute","getElementById","click","Home","PageUp","End","PageDown","Escape","Tab","role","tabIndex","DEFAULT_ITEM_TAG","Item","scrollIntoView","block","textContent","toLowerCase","handleFocus","handleMove","handleLeave","onFocus","onPointerMove","onMouseMove","onPointerLeave","onMouseLeave","useComputed","dependencies","setValue","cbRef","ListboxStates","CloseListbox","listboxState","activeOptionIndex","OpenListbox","SetDisabled","GoToOption","options","option","RegisterOption","UnregisterOption","nextOptions","currentActiveOption","ListboxContext","useListboxContext","Listbox","DEFAULT_LISTBOX_TAG","onChange","propsRef","labelRef","optionsRef","labelledby","DEFAULT_LABEL_TAG","Label","DEFAULT_OPTIONS_TAG","OptionsRenderFeatures","Options","DEFAULT_OPTION_TAG","Option","selected","select","GroupContext","useGroupContext","DEFAULT_GROUP_TAG","Group","switchElement","setSwitchElement","labelElement","setLabelElement","label","setSwitch","setLabel","DEFAULT_SWITCH_TAG","Switch","checked","groupContext","toggle","handleKeyUp","handleKeyPress","onKeyUp","onKeyPress"],"mappings":"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"}